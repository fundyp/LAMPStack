<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

  <!-- Font links -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Concert+One&display=swap" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="signin.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet">
  <link href="css/custom-styles.css" rel="stylesheet">

  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

  <title>Log In / Sign Up</title>

  
  <style>
    body {
            font-family: 'Concert One', sans-serif !important;
            background-color: #D2F3FF !important;
        }

        .navbar {
            font-family: 'Concert One', sans-serif !important;
        }

        .navbar-nav .nav-link {
            font-family: 'Concert One', sans-serif !important;
            margin-right: 25px;
        }

        .navbar .nav-link:hover {
          color: #ffc603
        }

        .custom-yellow {
            color: #ffc603
        }

        .custom-text-blue {
            color: #001E3E
        }

        .custom-box-blue {
          color: #001E3E
        }

        .custom-active-navbar {
          color: #ffffff
        }

        .wrapper {
          max-width: 820px;
          margin: 0 auto;
          padding: 10px;
          background: #94C6CD;
          color: #2d3f5e;
          border-radius: 40px;
        }

        .input-box {
          text-align: center;
          margin: 30px;
          margin-left: 14%;
          position: relative;
        }


        .input-box input::placeholder {
          color: #000000
        }

        .wrapper h1 {
          font-size: 72px;
          text-align: center;
        }

        .wrapper .input-box {
          width: 60%;
          height: 60px;
          
        }

        .login-container {
          width: 80%; /* Adjust the width as needed */
          margin: 0 auto;
        }

        

        .input-box input {
          width: 100%; /* Adjust the width as needed */
          height: 100%;
          background: rgb(203, 243, 243);
          border: none;
          outline: none;
          border: 2px solid rgb(47, 126, 150);
          border-radius: 40px;
          font-size: 28px;
          color: #000000;
          text-align: left;
          padding-left: 6%;
          /* box-sizing: border-box; */
        }

        .input-box i {
          position: absolute;
          right: -7%;
          top: 25%;
          font-size: 28px;
          transform: translateY(-50%, -50%);
        }


  </style>

</head>
<body class="text-center custom-background">

  <main class="form-signin">
    <!-- Log In Form -->
    <form id="logInForm">
      <!-- Add existing code for your logo -->
      <!-- <img class="mb-4" src="/path-to-your-logo.png" alt="" width="72" height="57"> -->


      
      <div class="container-fluid px-0 mx-0">
        <nav class="navbar navbar-expand-sm bar-color fs-5 m-0 p-0">
          <a class="navbar-brand mb-0 h1">
            <img class="d-inline-block align-top" src="css/logo-Denver-Nuggets.png" alt="Denver Logo" width="150" height="auto">
          </a>
          <button type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" class="navbar-toggler" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle Navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse flex-grow-0" id="navbarNav">
            <ul class="navbar-nav text-center">
              <li class="nav-item active">
                <a href="index.html" class="nav-link custom-active-navbar active" style="font-family: 'Concert One', sans-serif !important;">
                  Home
                </a>
              </li>
              <li class="nav-item active">
                <a href="signIn.html" class="nav-link disabled" style="font-family: 'Concert One', sans-serif !important;">
                  Sign&nbsp;In
                </a>
              </li>
              <li class="nav-item active">
                <a href="#" class="nav-link custom-active-navbar active" style="font-family: 'Concert One', sans-serif !important;">
                  About
                </a>
              </li>
            </ul>
          </div>
    
          <div class="ms-auto" style="position:relative; right:30px">
            <span class="navbar-text custom-yellow">Group 1 Project</span>
        </div>
        </nav>
      </div>
        

      <!-- empty space please ignore-->
      <div style="margin-top: 6vh;">
      </div>
       

      <div class="wrapper container login-container">
        <form id="logInForm" class="form-signin">
          <!-- login box starts here-->
          <h1>Login</h1>
          <div class="input-box"> 
            <input type="text" id="usernameLogin" placeholder="Username" required>
              <i class='bx bxs-user'></i>
          </div>
          <div class="input-box">
            <input type="text" id="passwordLogin" placeholder="Type Your Username" required>
              <i class='bx bxs-lock-alt'></i>
          </div>

          <button type="submit" class="btn" onclick="handleLogin()">Login</button>

          <div class="register-link">
            <p>Don't have an account? <a href="#" onclick="switchForm('signUpForm')">Sign Up Now</a></p>
          </div>

        </form>
      </div>

      <div style="margin-top: 6vh;">
      </div>

    

      
      <!-- Add existing code for the "Log In" header 
      <h1 class="h3 mb-3 fw-normal">Log In</h1>
      -->
      <!-- Add existing code for the username and password input fields 
      <div class="form-floating">
        <input type="text" class="form-control" id="usernameLogin" placeholder="Username" required>
        <label for="usernameLogin">Username</label>
      </div>
      <div class="form-floating">
        <input type="password" class="form-control" id="passwordLogin" placeholder="Password" required>
        <label for="passwordLogin">Password</label>
      </div> -->

      <!-- Button to trigger the login 
      <button class="w-100 btn btn-lg btn-primary" type="button" onclick="handleLogin()">Log In</button>

      -->
      <!-- Add existing code for the "Don't have an account?" link -->
      <!--
      <p class="mt-3">
        Don't have an account? <a href="#" onclick="switchForm('signUpForm')">Sign Up</a>
      </p>
    -->

    </form>



    <!-- Sign Up Form -->
    <form id="signUpForm" style="display: none;">
      <!-- Add existing code for your logo -->
      <!-- <img class="mb-4" src="/path-to-your-logo.png" alt="" width="72" height="57"> -->


      <!-- this is our top navbar -->
      <div class="container-fluid px-0 mx-0">
        <nav class="navbar navbar-expand-sm bar-color fs-5 m-0 p-0">
          <a class="navbar-brand mb-0 h1">
            <img class="d-inline-block align-top" src="css/logo-Denver-Nuggets.png" alt="Denver Logo" width="150" height="auto">
          </a>
          <button type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" class="navbar-toggler" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle Navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse flex-grow-0" id="navbarNav">
            <ul class="navbar-nav text-center">
              <li class="nav-item active">
                <a href="index.html" class="nav-link custom-active-navbar active" style="font-family: 'Concert One', sans-serif !important;">
                  Home
                </a>
              </li>
              <li class="nav-item active">
                <a href="signIn.html" class="nav-link disabled" style="font-family: 'Concert One', sans-serif !important;">
                  Sign&nbsp;In
                </a>
              </li>
              <li class="nav-item active">
                <a href="index.html" class="nav-link custom-active-navbar active" style="font-family: 'Concert One', sans-serif !important;">
                  About
                </a>
              </li>
            </ul>
          </div>
    
          <div class="ms-auto" style="position:relative; right:30px">
            <span class="navbar-text custom-yellow">Group 1 Project</span>
        </div>
        </nav>
      </div>
        
        
        </nav>
      </div>

      
      <!-- Add existing code for the "Sign Up" header -->
      <h1 class="h3 mb-3 fw-normal">Sign Up</h1>
      <div class="form-floating">
        <input type="text" class="form-control" id="firstNameSignUp" placeholder="First Name" required>
          <label for="firstNameSignUp">First Name</label>
      </div>
      <div class="form-floating">
        <input type="text" class="form-control" id="lastNameSignUp" placeholder="Last Name" required>
          <label for="lastNameSignUp">Last Name</label>
      </div>
      <div class="form-floating">
        <input type="text" class="form-control" id="usernameSignUp" placeholder="Username" required>
        <label for="usernameSignUp">Username</label>
      </div>
      <div class="form-floating">
        <input type="password" class="form-control" id="passwordSignUp" placeholder="Password" required>
        <label for="passwordSignUp">Password</label>
      </div>

      <!-- Button to trigger the signup -->
      <button class="w-100 btn btn-lg btn-primary" type="button" onclick="handleSignUp()">Sign Up</button>

      <!-- Add existing code for the "Already have an account?" link -->
      <p class="mt-3">
        Already have an account? <a href="#" onclick="switchForm('logInForm')">Log In</a>
      </p>
    </form>
  </main>

  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

  <!-- Add existing code for the switchForm function -->
  <script>
    const baseURL = 'http://nugget-nation.xyz';


// async function loginUser(login, password) {
//   try {
//     const response = await fetch(`${baseURL}/LAMPAPI/Login.php`, {
//       method: 'POST',
//       headers: {
//         'Content-Type': 'application/json',
//       },
//       body: JSON.stringify({ login, password }),
//     });

//     const data = await response.json();

//     if (response.ok) {
//       if (data.success) {
//         console.log('Login successful');
//         console.log('UserID:', data.id);
//         document.cookie = `userID=${encodeURIComponent(data.id)}; path=/`; // Set userID cookie

//         // Add this line to check if the cookie is properly set
//         console.log('UserID (from cookie):', getCookie('userID'));

//         redirectUser(login);
//         // Handle successful login 
//       } else {
//         console.error('Login failed:', data.error);
//         // Handle failed login
//       }
//     } else {
//       console.error('Login failed:', data.error);
//       // Handle failed login
//     }
//   } catch (error) {
//     console.error('Error during login:', error);
//     // Handle other errors
//   }
// }


async function loginUser(login, password) {
  try {
    const response = await fetch(`${baseURL}/LAMPAPI/Login.php`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ login, password }),
    });

    const data = await response.json();

    if (response.ok) {
      if (data.success) {
        console.log('Login successful');
        console.log('UserID:', data.id);

        // Set cookies for userID, firstName, and lastName
        document.cookie = `userID=${encodeURIComponent(data.id)}; path=/`;
        document.cookie = `firstName=${encodeURIComponent(data.firstName)}; path=/`;
        document.cookie = `lastName=${encodeURIComponent(data.lastName)}; path=/`;

        // Add these lines to check if the cookies are properly set
        console.log('UserID (from cookie):', getCookie('userID'));
        console.log('FirstName (from cookie):', getCookie('firstName'));
        console.log('LastName (from cookie):', getCookie('lastName'));

        redirectUser(login);
        // Handle successful login 
      } else {
        console.error('Login failed:', data.error);
        // Handle failed login
      }
    } else {
      console.error('Login failed:', data.error);
      // Handle failed login
    }
  } catch (error) {
    console.error('Error during login:', error);
    // Handle other errors
  }
}




    async function signUpUser(userData) 
    {
      try 
      {
        const response = await fetch(`${baseURL}/LAMPAPI/Registration.php`, 
        {
          method: 'POST',
          headers: 
          {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(userData),
        });

        const data = await response.json();

        if (response.ok) 
        {
          console.log('Registration successful');
          switchForm('logInForm');
          // Handle successful registration
        } else 
        {
          console.error('Registration failed:',data.error);
          // Handle failed registration
        }
      } catch (error) 
      {
        console.error('Error during registration:', error);
        // Handle other errors
      }
    }

    function handleLogin() 
    {
      const login = document.getElementById('usernameLogin').value;
      const password = document.getElementById('passwordLogin').value;

      // Use fetch or any other login logic here
      loginUser(login, password);
    }

    function handleSignUp() 
    {
      const firstName = document.getElementById('firstNameSignUp').value;
      const lastName = document.getElementById('lastNameSignUp').value;
      const login = document.getElementById('usernameSignUp').value; 
      const password = document.getElementById('passwordSignUp').value;

      const userData = 
      {
          firstName,
          lastName,
          login, 
          password,
      };

      signUpUser(userData);
    }


    function switchForm(formId) {
      document.getElementById('logInForm').style.display = 'none';
      document.getElementById('signUpForm').style.display = 'none';

      document.getElementById(formId).style.display = 'block';
    }

    function redirectUser(login) {
      const redirectURL = `http://nugget-nation.xyz/manager.html?login=${encodeURIComponent(login)}`;
      window.location.href = redirectURL;
    }   

    function getCookie(name) {
      const cookies = document.cookie.split(';');
      for (const cookie of cookies) {
        const [cookieName, cookieValue] = cookie.split('=');
        if (cookieName.trim() === name) {
          return decodeURIComponent(cookieValue);
        }
      }
      return null;
    }

  </script>

</body>
</html>
